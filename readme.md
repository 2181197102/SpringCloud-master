[![Build Status](https://travis-ci.org/zhoutaoo/SpringCloud.svg?branch=master)](https://travis-ci.org/zhoutaoo/SpringCloud)
[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![codecov](https://codecov.io/gh/zhoutaoo/SpringCloud/branch/master/graph/badge.svg)](https://codecov.io/gh/zhoutaoo/SpringCloud)




## æ¶æ„ç‰¹ç‚¹

```
1. ç»Ÿä¸€Restfulçš„å“åº”æŠ¥æ–‡ï¼Œcontrollè¿”å›åŸå§‹ç±»å‹å³å¯ï¼Œæ— éœ€æ‰‹åŠ¨åŒ…è£…ï¼Œç®€åŒ–ä»£ç ï¼Œå¯è¯»æ€§æ›´å¥½ã€‚

2. ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œå°è£…äº†åŸºæœ¬çš„å¼‚å¸¸çš„å“åº”ï¼Œå¦‚å‚æ•°æ£€éªŒã€æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚ç®€åŒ–ä»£ç ï¼Œæ›´æ–¹ä¾¿æ‰©å±•ã€‚

3. é»˜è®¤é›†æˆSwagger 3.0 APIæ–‡æ¡£ï¼Œæ–¹ä¾¿æ¥å£æ–‡æ¡£çš„ä¼ é€’ã€åä½œä¸è°ƒè¯•ã€‚

4. æ ‡å‡†åŒ–WEBå¯¹è±¡ä¼ é€’/è½¬æ¢/ä½¿ç”¨ï¼Œæ–¹ä¾¿ç»Ÿä¸€å¼€å‘é£æ ¼ï¼Œç®€åŒ–æ“ä½œã€‚

5. æ¡†æ¶/ç¯å¢ƒç­‰å…ƒæ•°æ®è‡ªåŠ¨æ”¶é›†æ³¨å†Œè‡³propertieså’ŒNacosï¼Œæ–¹ä¾¿ç³»ç»Ÿè¿è¡Œæ—¶ä½œä¸ºæ‰©å±•åˆ¤æ–­ï¼Œä¿¡æ¯å¤„ç†ã€‚

6. ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æ”¶é›†æ‰€æœ‰Restful urlæ³¨å†Œåˆ°æƒé™èµ„æºï¼Œæ–¹ä¾¿è¿›è¡Œé›†ä¸­æƒé™ç®¡ç†å’Œæˆæƒä½¿ç”¨ã€‚

7. å¤šæœºæˆ¿/åŒæ´»è·¯ç”±è´Ÿè½½æ‰©å±•æ”¯æŒï¼Œè‡ªå®šä¹‰è·¯ç”±å’Œè´Ÿè½½è§„åˆ™ï¼Œæ›´çµæ´»ã€å¯æ§ã€‚

8. é»˜è®¤å¼•å…¥spring validationï¼Œå¹¶æ‰©å±•æšä¸¾ã€æ‰‹æœºå·ç­‰å¸¸ç”¨æ ¡éªŒæ³¨è§£ã€‚

9. é»˜è®¤å¼•å…¥æ—¥å¿—traceã€actuatorç­‰ç»„ä»¶ï¼Œç»Ÿä¸€æ—¥å¿—æ‰“å°æ ¼å¼ã€‚

10. æ•´ä½“ç³»ç»ŸåŒ–ä¸ºä¸‰å±‚ï¼Œframeworkæ¡†æ¶ã€frameworkç»„ä»¶ã€åŸºç¡€åº”ç”¨ï¼Œå±‚æ¬¡æ›´æ¸…æ¥šï¼Œç»“æ„æ›´åˆç†ã€‚

11. é…ç½®ä¸­å¿ƒï¼Œåˆ’åˆ†æ¡†æ¶å…¨å±€é…ç½®ä¸åº”ç”¨é…ç½®ï¼ˆç†”æ–­é™çº§ã€ç½‘å…³è·¯ç”±ï¼‰ï¼Œè§„åˆ’ä¸­ã€‚
```



## å¿«é€Ÿå¼€å§‹

### å…ˆå†³æ¡ä»¶

é¦–å…ˆæœ¬æœºå…ˆè¦å®‰è£…ä»¥ä¸‹ç¯å¢ƒï¼Œå»ºè®®å…ˆå­¦ä¹ äº†è§£springbootå’ŒspringcloudåŸºç¡€çŸ¥è¯†ã€‚

- [git](https://git-scm.com/)
- [java8](http://www.oracle.com/technetwork/java/javase/downloads/index.html) 
- [maven](http://maven.apache.org/) 

### å¼€å‘ç¯å¢ƒæ­å»º

linuxå’Œmacä¸‹å¯åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ `./install.sh` å¿«é€Ÿæ­å»ºå¼€å‘ç¯å¢ƒã€‚å¦‚è¦äº†è§£å…·ä½“çš„æ­¥éª¤ï¼Œè¯·çœ‹å¦‚ä¸‹æ–‡æ¡£ã€‚

**å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š**

1. å…‹éš†ä»£ç åº“ï¼š `git clone https://github.com/zhoutaoo/SpringCloud.git`

2. å®‰è£…å…¬å…±åº“åˆ°æœ¬åœ°ä»“åº“ï¼š 

`mvn -pl ./common,./auth/authentication-client install`

3. ç”Ÿæˆideé…ç½®ï¼š `mvn idea:idea`æˆ–`mvn eclipse:eclipse` å¹¶å¯¼å…¥å¯¹åº”çš„ideè¿›è¡Œå¼€å‘ï¼ŒIDEå®‰è£…lombokæ’ä»¶ï¼ˆå¾ˆé‡è¦ï¼Œå¦åˆ™IDEä¼šæ˜¾ç¤ºç¼–è¯‘æŠ¥é”™ï¼‰

### ç¼–è¯‘ & å¯åŠ¨

* 1.å¯åŠ¨åŸºç¡€æœåŠ¡ï¼šè¿›å…¥docker-composeç›®å½•ï¼Œæ‰§è¡Œ`docker-compose -f docker-compose.yml up` æˆ–å•ä¸ªå¯åŠ¨`docker-compose up æœåŠ¡å`, æœåŠ¡åå¦‚ä¸‹

åœ¨å¯åŠ¨åº”ç”¨ä¹‹å‰ï¼Œéœ€è¦å…ˆå¯åŠ¨æ•°æ®åº“ã€ç¼“å­˜ã€MQç­‰ä¸­é—´ä»¶ï¼Œå¯æ ¹æ®è‡ªå·±éœ€è¦å¯åŠ¨çš„åº”ç”¨é€‰æ‹©å¯åŠ¨æŸäº›åŸºç¡€ç»„ä»¶ï¼Œä¸€èˆ¬æ¥è¯´å¯åŠ¨mysqlã€redisã€rabbitmqå³å¯ï¼Œå…¶å®ƒç»„ä»¶è‹¥æœ‰éœ€è¦ï¼Œæ ¹æ®å¦‚ä¸‹å‘½ä»¤å¯åŠ¨å³å¯ã€‚

è¯¥æ­¥éª¤ä½¿ç”¨äº†dockerå¿«é€Ÿæ­å»ºç›¸åº”çš„åŸºç¡€ç¯å¢ƒï¼Œéœ€è¦ä½ å¯¹dockerã€docker-composeæœ‰ä¸€å®šäº†è§£å’Œä½¿ç”¨ç»éªŒã€‚ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨dockerï¼Œè‡ªè¡Œæ­å»ºä»¥ä¸‹æœåŠ¡å³å¯ã€‚

|  æœåŠ¡           |   æœåŠ¡å         |  ç«¯å£     | å¤‡æ³¨                                            |
|----------------|-----------------|-----------|-------------------------------------------------|
|  æ•°æ®åº“         |   mysql         |  3306     |  ç›®å‰å„åº”ç”¨å…±ç”¨1ä¸ªå®ä¾‹ï¼Œå„åº”ç”¨å¯å»ºä¸åŒçš„database     |
|  KVç¼“å­˜         |   redis         |  6379     |  ç›®å‰å…±ç”¨ï¼ŒåŸåˆ™ä¸Šå„åº”ç”¨å•ç‹¬å®ä¾‹    |
|  æ¶ˆæ¯ä¸­é—´ä»¶      |   rabbitmq      |  5672     |  å…±ç”¨                          |
|  æ³¨å†Œä¸é…ç½®ä¸­å¿ƒ  |   nacos         |  8848     |  [å¯åŠ¨å’Œä½¿ç”¨æ–‡æ¡£](./docs/register.md)             |
|  æ—¥å¿—æ”¶é›†ä¸­é—´ä»¶  |   zipkin-server |  9411     |  å…±ç”¨                          |
|  æœç´¢å¼•æ“ä¸­é—´ä»¶  |   elasticsearch |  9200     |  å…±ç”¨    |
|  æ—¥å¿—åˆ†æå·¥å…·    |   kibana        |  5601     |  å…±ç”¨    |
|  æ•°æ®å¯è§†åŒ–å·¥å…·  |   grafana       |  3000     |  å…±ç”¨    |

* 2.åˆ›å»ºæ•°æ®åº“åŠè¡¨

åªæœ‰éƒ¨åˆ†åº”ç”¨æœ‰æ•°æ®åº“è„šæœ¬ï¼Œè‹¥å¯åŠ¨çš„åº”ç”¨æœ‰æ•°æ®åº“çš„ä¾èµ–ï¼Œè¯·åˆä½¿åŒ–è¡¨ç»“æ„å’Œæ•°æ®åå†å¯åŠ¨åº”ç”¨ã€‚

dockeræ–¹å¼è„šæœ¬åˆä½¿åŒ–ï¼šè¿›å…¥docker-composeç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ `docker-compose up mysql-init`

**å­é¡¹ç›®è„šæœ¬**

è·¯å¾„ä¸€èˆ¬ä¸ºï¼šå­é¡¹ç›®/db

å¦‚ï¼š`auth/db` ä¸‹çš„è„šæœ¬ï¼Œè¯·å…ˆæ‰§è¡Œddlå»ºç«‹è¡¨ç»“æ„åå†æ‰§è¡Œdmlæ•°æ®åˆä½¿åŒ–

**åº”ç”¨è„šæœ¬**

è·¯å¾„ä¸€èˆ¬ä¸ºï¼šå­é¡¹ç›®/åº”ç”¨å/src/main/db

å¦‚ï¼šdemos/producer/src/main/db ä¸‹çš„è„šæœ¬

* 3.å¯åŠ¨åº”ç”¨

æ ¹æ®è‡ªå·±éœ€è¦ï¼Œå¯åŠ¨ç›¸åº”æœåŠ¡è¿›è¡Œæµ‹è¯•ï¼Œcd è¿›å…¥ç›¸å…³åº”ç”¨ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š `mvn spring-boot:run` 

ä»¥ä¸‹åº”ç”¨éƒ½ä¾èµ–äºrabbitmqã€nacosï¼Œå¯åŠ¨æœåŠ¡å‰è¯·å…ˆå¯åŠ¨mqå’Œæ³¨å†Œä¸­å¿ƒ

| æœåŠ¡åˆ†ç±»  | æœåŠ¡å                     |  ä¾èµ–åŸºç¡€ç»„ä»¶             |   ç®€ä»‹      |  åº”ç”¨åœ°å€                | æ–‡æ¡£                    |
|----------|---------------------------|-------------------------|-------------|-------------------------|-------------------------|
|  center  | bus-server                |                         |  æ¶ˆæ¯ä¸­å¿ƒ    |  http://localhost:8071  | [æ¶ˆæ¯ä¸­å¿ƒæ–‡æ¡£](./center/bus)         |
|  sysadmin| organization              | mysqlã€redis            |  ç”¨æˆ·ç»„ç»‡åº”ç”¨ |  http://localhost:8010  | å¾…å®Œå–„      |
|  auth    | authorization-server      | mysqlã€organization     |  æˆæƒæœåŠ¡    |  http://localhost:8000  | [æƒé™æœåŠ¡ç®€ä»‹](./auth) ã€[æˆæƒserveræ–‡æ¡£](./auth/authorization-server)     |
|  auth    | authentication-server     | mysqlã€organization     |  è®¤è¯æœåŠ¡    |  http://localhost:8001  | [è®¤è¯serveræ–‡æ¡£](./auth/authentication-server)    |
|  auth    | authentication-client     | æ—                       |  è®¤è¯å®¢æˆ·ç«¯  |  jaråŒ…å¼•å…¥               |      |
|  gateway | gateway-web               | redis                   |  WEBç½‘å…³    |  http://localhost:8443  | [WEBç½‘å…³ç®€ä»‹](./gateway)  [WEBç½‘å…³æ–‡æ¡£](./gateway/gateway-web)       |
|  gateway | gateway-admin             | mysqlã€redis            |  ç½‘å…³ç®¡ç†    |  http://localhost:8445  | [ç½‘å…³ç®¡ç†åå°æ–‡æ¡£](./gateway/gateway-admin)   |
|  monitor | admin                     |                         |  æ€»ä½“ç›‘æ§    |  http://localhost:8022  |      |

* 4.æ¡ˆä¾‹ç¤ºæ„å›¾

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç”¨æˆ·è®¿é—®çš„çš„ç¤ºæ„å›¾ï¼Œç”¨æˆ·è¯·æ±‚é€šè¿‡gateway-webåº”ç”¨ç½‘å…³è®¿é—®åç«¯åº”ç”¨ï¼Œé€šè¿‡authorization-serveråº”ç”¨ç™»é™†æˆæƒæ¢å–tokenï¼Œè¯·æ±‚é€šè¿‡authentication-serveråº”ç”¨è¿›è¡Œæƒé™ç­¾åˆ«åè½¬å‘åˆ°"æ‚¨çš„ä¸šåŠ¡åº”ç”¨"ä¸­

authorization-serverä¸ºæˆæƒåº”ç”¨ï¼Œå¯åŠ¨å‰è¯·åˆä½¿åŒ–å¥½æ•°æ®åº“ï¼Œ[æˆæƒServeræ–‡æ¡£](./auth/authorization-server)ã€‚

authentication-serverä¸ºç­¾æƒåº”ç”¨ï¼Œè‹¥æœ‰æ–°å¢æ¥å£ï¼Œè¯·åˆä½¿åŒ–ç›¸å…³æƒé™æ•°æ®åˆ°resourceè¡¨ä¸­ã€‚

gateway-adminå¯åŠ¨æ€è°ƒæ•´gateway-webçš„è·¯ç”±ç­–ç•¥ï¼Œæµ‹è¯•å‰è¯·å…ˆé…ç½®ç½‘å…³çš„è½¬å‘ç­–ç•¥ï¼Œ[è·¯ç”±ç­–ç•¥é…ç½®](https://github.com/zhoutaoo/SpringCloud/tree/master/gateway/gateway-admin#%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97)ã€‚

[ç¤ºæ„å›¾](https://www.processon.com/view/link/5cc05ff9e4b059e20a06e3c4)

* 6.å‰ç«¯é¡¹ç›®

ç¡®ç¡®ä¿gateway-adminã€gateway-webã€organizationã€authorization-serverã€authentication-serveræœåŠ¡å¯åŠ¨ï¼Œç„¶åå¯åŠ¨

[å‰ç«¯é¡¹ç›®](https://github.com/zhoutaoo/SpringCloud-Admin)ï¼ˆè¯¥é¡¹ç›®ç›®å‰è¿˜åœ¨å¼€å‘ä¸­ï¼‰

å¤§å®¶å¯åŠ¨å¦‚æœ‰é—®é¢˜ï¼Œå¯ä»¥å…ˆåˆ°è¿™é‡Œçœ‹çœ‹ï¼Œä¹Ÿå¯ä»¥åŠ å…¥äº¤æµç¾¤

[å¸¸è§é—®é¢˜](https://github.com/zhoutaoo/SpringCloud/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98)


### æµ‹è¯•

è¿è¡Œ `mvn test` å¯åŠ¨æµ‹è¯•.

## æ¶æ„ä¸å¼€å‘

[æ¶æ„](https://www.processon.com/view/link/597ffa52e4b06a973c4d86ba)

## å¼€å‘æŒ‡å—

[å¼€å‘æŒ‡å—](docs/development.md)

## åŠŸèƒ½ä¸ç‰¹æ€§

### åŠŸèƒ½é¢„è§ˆ

**ç”¨æˆ·ç®¡ç†**
 ![ç”¨æˆ·ç®¡ç†](https://user-images.githubusercontent.com/3946731/67155765-93d5ca00-f347-11e9-8114-44ac5ba3d05b.png)
 
 **è§’è‰²ç®¡ç†**
 ![è§’è‰²ç®¡ç†](https://user-images.githubusercontent.com/3946731/67155755-7c96dc80-f347-11e9-9b0a-e13b51167422.png)
 
 **æœåŠ¡å®¹é”™**
 ![æœåŠ¡å®¹é”™](https://user-images.githubusercontent.com/3946731/67155757-88829e80-f347-11e9-8750-d5c4eef7730e.png)
 
 **APIæ–‡æ¡£**
 ![APIæ–‡æ¡£](https://user-images.githubusercontent.com/3946731/67155763-8e787f80-f347-11e9-8347-ab2aeda6f7d6.png)
 
 **ç»„ç»‡æ¶æ„ç®¡ç†**
 ![ç»„ç»‡æ¶æ„ç®¡ç†](https://user-images.githubusercontent.com/3946731/67155751-69840c80-f347-11e9-8d88-e6fa4d6b7d23.png)

### åŸºç¡€æœåŠ¡

|  æœåŠ¡     | ä½¿ç”¨æŠ€æœ¯                 |   è¿›åº¦        |    å¤‡æ³¨   |
|----------|-------------------------|---------------|-----------|
|  æ³¨å†Œä¸­å¿ƒ | Nacos                   |   âœ…          |           |
|  é…ç½®ä¸­å¿ƒ | Nacos                   |   âœ…          |           |
|  æ¶ˆæ¯æ€»çº¿ | SpringCloud Bus+Rabbitmq|   âœ…          |           |
|  ç°åº¦åˆ†æµ | OpenResty + lua         |   ğŸ—          |           |
|  åŠ¨æ€ç½‘å…³ | SpringCloud Gateway     |   âœ…          |  å¤šç§ç»´åº¦çš„æµé‡æ§åˆ¶ï¼ˆæœåŠ¡ã€IPã€ç”¨æˆ·ç­‰ï¼‰ï¼Œåç«¯å¯é…ç½®åŒ–ğŸ—          |
|  æˆæƒè®¤è¯ | Spring Security OAuth2  |   âœ…          |  Jwtæ¨¡å¼   |
|  æœåŠ¡å®¹é”™ | SpringCloud Sentinel    |   âœ…          |           |
|  æœåŠ¡è°ƒç”¨ | SpringCloud OpenFeign   |   âœ…          |           |
|  å¯¹è±¡å­˜å‚¨ | FastDFS/Minio           |   ğŸ—          |           |
|  ä»»åŠ¡è°ƒåº¦ | Elastic-Job             |   ğŸ—          |           |
|  åˆ†åº“åˆ†è¡¨ | Mycat                   |   ğŸ—          |           |
|  æ•°æ®æƒé™ |                         |   ğŸ—          |  ä½¿ç”¨mybatiså¯¹åŸæŸ¥è¯¢åšå¢å¼ºï¼Œä¸šåŠ¡ä»£ç ä¸ç”¨æ§åˆ¶ï¼Œå³å¯å®ç°ã€‚         |

### å¹³å°åŠŸèƒ½

|  æœåŠ¡     | ä½¿ç”¨æŠ€æœ¯     |   è¿›åº¦         |    å¤‡æ³¨   |
|----------|-------------|---------------|-----------|
|  ç”¨æˆ·ç®¡ç† | è‡ªå¼€å‘       |   âœ…          |  ç”¨æˆ·æ˜¯ç³»ç»Ÿæ“ä½œè€…ï¼Œè¯¥åŠŸèƒ½ä¸»è¦å®Œæˆç³»ç»Ÿç”¨æˆ·é…ç½®ã€‚          |
|  è§’è‰²ç®¡ç† | è‡ªå¼€å‘       |   âœ…          |  è§’è‰²èœå•æƒé™åˆ†é…ã€è®¾ç½®è§’è‰²æŒ‰æœºæ„è¿›è¡Œæ•°æ®èŒƒå›´æƒé™åˆ’åˆ†ã€‚   |
|  èœå•ç®¡ç† | è‡ªå¼€å‘       |   ğŸ—          |  é…ç½®ç³»ç»Ÿèœå•ï¼Œæ“ä½œæƒé™ï¼ŒæŒ‰é’®æƒé™æ ‡è¯†ç­‰ã€‚               |
|  æœºæ„ç®¡ç† | è‡ªå¼€å‘       |   ğŸ—          |  é…ç½®ç³»ç»Ÿç»„ç»‡æœºæ„ï¼Œæ ‘ç»“æ„å±•ç°ï¼Œå¯éšæ„è°ƒæ•´ä¸Šä¸‹çº§ã€‚        |
|  ç½‘å…³åŠ¨æ€è·¯ç”± | è‡ªå¼€å‘    |   ğŸ—          |  ç½‘å…³åŠ¨æ€è·¯ç”±ç®¡ç†                                     |

### å¼€å‘è¿ç»´

|  æœåŠ¡     | ä½¿ç”¨æŠ€æœ¯                 |   è¿›åº¦         |    å¤‡æ³¨   |
|----------|-------------------------|---------------|-----------|
|  ä»£ç ç”Ÿæˆ |                         |   ğŸ—          |  å‰åç«¯ä»£ç çš„ç”Ÿæˆï¼Œæ”¯æŒVue         |
|  æµ‹è¯•ç®¡ç† |                         |   ğŸ—          |           |
|  æ–‡æ¡£ç®¡ç† | Swagger2                |   âœ…          |           |
|  æœåŠ¡ç›‘æ§ | Spring Boot Admin       |   âœ…          |           |
|  é“¾è·¯è¿½è¸ª | SkyWalking              |   âœ…          |           |
|  æ“ä½œå®¡è®¡ |                         |   ğŸ—          |  ç³»ç»Ÿå…³é”®æ“ä½œæ—¥å¿—è®°å½•å’ŒæŸ¥è¯¢         |
|  æ—¥å¿—ç®¡ç† | ES + Kibanaã€Zipkin     |   âœ…          |           |
|  ç›‘æ§å‘Šè­¦ | Grafana                 |   âœ…          |           |

## æ›´æ–°æ—¥å¿—

**2019-10-18ï¼š** 

1.ä½¿ç”¨nacosæ›¿ä»£eurekaä¸ºæœåŠ¡çš„æ³¨å†Œä¸­å¿ƒ

2.ä½¿ç”¨nacosæ›¿ä»£apolloä¸ºæœåŠ¡çš„é…ç½®ä¸­å¿ƒ

3.å¼•å…¥ä½¿ç”¨sentinelæ›¿æ¢æ‰hystrixï¼Œå¼•å…¥sentinel-dashboard

4.ä½¿ç”¨jetcacheä½œä¸¤çº§ç¼“å­˜ï¼Œä¼˜åŒ–ç¼“å­˜æ€§èƒ½

5.ç½‘å…³å¯åŠ¨æ—¶åŠ è½½æ•°æ®åº“ä¸­çš„è·¯ç”±åˆ°redisç¼“å­˜

6.å…¶å®ƒå·²çŸ¥bugä¿®å¤
